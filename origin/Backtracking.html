
<!-- saved from url=(0053)http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html -->
<html lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="./Backtracking_files/style.css">
<title>演算法筆記 - Backtracking</title><style>.GFXAJ1NJF{width:510px;text-align:center;margin-top:5px;font-family:Arial Unicode MS, Arial, sans-serif;line-height:normal;}.GFXAJ1NIF{border:solid 1px black;width:500px;margin-left:auto;margin-right:auto;margin-bottom:5px;}.GFXAJ1NKF{width:50px;}</style><style>.G63lnkrD{width:460px;text-align:center;margin-top:5px;font-family:Arial Unicode MS, Arial, sans-serif;line-height:normal;}.G63lnkrG{width:50px;}.G63lnkrB{border:solid 1px black;width:450px;margin-left:auto;margin-right:auto;margin-bottom:5px;font-size:large;}.G63lnkrE{text-align:center;margin-left:auto;margin-right:auto;margin-bottom:5px;}.G63lnkrF{width:450px;height:120px;margin-left:auto;margin-right:auto;margin-bottom:5px;border:1px solid black;text-align:left;background:#e0e0e0;font-size:small;}.G63lnkrF ul{padding-left:25px;padding-right:5px;margin-top:10px;}.G63lnkrF li{margin-top:5px;}.G63lnkrD td{border-bottom:solid 1px black;border-right:solid 1px black;width:20px;height:25px;font-size:normal;}.G63lnkrD table{border-spacing:0;border-top:solid 1px black;border-left:solid 1px black;}.G63lnkrC{background-color:yellow;}</style></head><body>
<div class="a" id="1"><div class="h">
<p class="b">Backtracking</p>
<p class="w">手把青秧插滿田，低頭便見水中天，　　　　　</p>
<p class="w">六根清淨方為道，退步原來是向前。《插秧詩》</p>
</div><div class="c">
<p class="t">Backtracking</p>
<p>中文稱作「回溯法」，枚舉多維度數值的方法。運用遞迴依序窮舉各個維度的數值，製作所有可能的多維度數值，並且在遞迴途中避免枚舉不正確的多維度數值。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">MAX_DIMENSION</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;多維度數值</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">dimension</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comments">/*&nbsp;prune：在遞迴途中避免枚舉不正確的多維度數值&nbsp;*/</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">solution</span><span>[]&nbsp;</span><span class="word">will</span><span>&nbsp;</span><span class="word">not</span><span>&nbsp;</span><span class="word">be</span><span>&nbsp;</span><span class="word">an</span><span>&nbsp;</span><span class="word">answer</span><span>&nbsp;)&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comments">/*&nbsp;製作了一組多維度數值，並檢驗正不正確&nbsp;*/</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">dimension</span><span>&nbsp;==&nbsp;</span><span class="word">MAX_DIMENSION</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">check</span><span>&nbsp;</span><span class="word">and</span><span>&nbsp;</span><span class="word">record</span><span>&nbsp;</span><span class="word">solution</span><span>[];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comments">/*&nbsp;窮舉這個維度的所有數值，並遞迴到下一個維度&nbsp;*/</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(&nbsp;</span><span class="word">x</span><span>&nbsp;=&nbsp;</span><span class="word">possible</span><span>&nbsp;</span><span class="word">value</span><span>&nbsp;</span><span class="word">of</span><span>&nbsp;</span><span class="word">current</span><span>&nbsp;</span><span class="word">dimension</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">dimension</span><span>]&nbsp;=&nbsp;</span><span class="word">x</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(&nbsp;</span><span class="word">dimension</span><span>&nbsp;+&nbsp;</span><span class="value">1</span><span>&nbsp;);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="type">int</span><span>&nbsp;</span><span class="word">main</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;從第一個維度開始枚舉</span></li><li><span>}</span></li></ol></div>
<p>當多維度數值只需要唯一一組，可以讓程式提早結束。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">MAX_DIMENSION</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">find_answer</span><span>&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;隨時記錄是否已經找到正解</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">dimension</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">dimension</span><span>&nbsp;==&nbsp;</span><span class="word">MAX_DIMENSION</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">check</span><span>&nbsp;</span><span class="word">and</span><span>&nbsp;</span><span class="word">record</span><span>&nbsp;</span><span class="word">solution</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">find_answer</span><span>&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp;</span><span class="comment">//&nbsp;找到正解了</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(&nbsp;</span><span class="word">x</span><span>&nbsp;=&nbsp;</span><span class="word">possible</span><span>&nbsp;</span><span class="word">value</span><span>&nbsp;</span><span class="word">of</span><span>&nbsp;</span><span class="word">current</span><span>&nbsp;</span><span class="word">dimension</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">dimension</span><span>]&nbsp;=&nbsp;</span><span class="word">x</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(&nbsp;</span><span class="word">dimension</span><span>&nbsp;+&nbsp;</span><span class="value">1</span><span>&nbsp;);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">find_answer</span><span>)&nbsp;</span><span class="keyword">return</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;提早結束，跳出遞迴</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>當多維度數值可以衡量優劣，就隨時剔除劣的、保留優的。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">MAX_DIMENSION</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">find_answer</span><span>&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">best_cost</span><span>;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用一數值代表多維度數值的優劣</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">dimension</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comments">/*&nbsp;bound：多維度數值太糟了，不可能成為正解，不必遞迴下去&nbsp;*/</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">cost</span><span>&nbsp;=&nbsp;</span><span class="word">cost</span><span>&nbsp;</span><span class="word">of</span><span>&nbsp;</span><span class="word">solution</span><span>[];&nbsp;&nbsp;</span><span class="comment">//&nbsp;計算優劣</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">cost</span><span>&nbsp;</span><span class="word">is</span><span>&nbsp;</span><span class="word">far</span><span>&nbsp;</span><span class="word">away</span><span>&nbsp;</span><span class="word">from</span><span>&nbsp;</span><span class="word">best_cost</span><span>&nbsp;)&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">dimension</span><span>&nbsp;==&nbsp;</span><span class="word">MAX_DIMENSION</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">check</span><span>&nbsp;</span><span class="word">and</span><span>&nbsp;</span><span class="word">record</span><span>&nbsp;</span><span class="word">solution</span><span>[];</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comments">/*&nbsp;bound：多維度數值夠好了，可以成為正解，不必遞迴下去&nbsp;*/</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_cost</span><span>&nbsp;=&nbsp;</span><span class="word">cost</span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄當前最佳結果</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(&nbsp;</span><span class="word">cost</span><span>&nbsp;</span><span class="word">is</span><span>&nbsp;</span><span class="word">enough</span><span>&nbsp;</span><span class="word">good</span><span>&nbsp;)&nbsp;</span><span class="word">find_answer</span><span>&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(&nbsp;</span><span class="word">x</span><span>&nbsp;=&nbsp;</span><span class="word">possible</span><span>&nbsp;</span><span class="word">value</span><span>&nbsp;</span><span class="word">of</span><span>&nbsp;</span><span class="word">current</span><span>&nbsp;</span><span class="word">dimension</span><span>&nbsp;)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">dimension</span><span>]&nbsp;=&nbsp;</span><span class="word">x</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(&nbsp;</span><span class="word">dimension</span><span>&nbsp;+&nbsp;</span><span class="value">1</span><span>&nbsp;);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">find_answer</span><span>)&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>回溯法的特色是隨時避免枚舉不正確的數值。一旦發現不正確的數值，就不遞迴至下一層，而是回溯至上一層，節省時間。</p>
<p>另外還可以調整維度先後順序、一個維度裡面的枚舉順序。如果安排得宜，可以更快找到正確的多維度數值。</p>
<p class="e">UVa <a href="http://uva.onlinejudge.org/external/1/140.html">140</a> <a href="http://uva.onlinejudge.org/external/1/165.html">165</a> <a href="http://uva.onlinejudge.org/external/1/193.html">193</a> <a href="http://uva.onlinejudge.org/external/2/222.html">222</a> <a href="http://uva.onlinejudge.org/external/2/259.html">259</a> <a href="http://uva.onlinejudge.org/external/2/291.html">291</a> <a href="http://uva.onlinejudge.org/external/3/301.html">301</a> <a href="http://uva.onlinejudge.org/external/3/331.html">331</a> <a href="http://uva.onlinejudge.org/external/3/399.html">399</a> <a href="http://uva.onlinejudge.org/external/4/435.html">435</a> <a href="http://uva.onlinejudge.org/external/5/524.html">524</a> <a href="http://uva.onlinejudge.org/external/5/539.html">539</a> <a href="http://uva.onlinejudge.org/external/5/565.html">565</a> <a href="http://uva.onlinejudge.org/external/5/574.html">574</a> <a href="http://uva.onlinejudge.org/external/5/598.html">598</a> <a href="http://uva.onlinejudge.org/external/6/628.html">628</a> <a href="http://uva.onlinejudge.org/external/6/656.html">656</a> <a href="http://uva.onlinejudge.org/external/7/732.html">732</a> <a href="http://uva.onlinejudge.org/external/101/10186.html">10186</a> <a href="http://uva.onlinejudge.org/external/103/10344.html">10344</a> <a href="http://uva.onlinejudge.org/external/103/10364.html">10364</a> <a href="http://uva.onlinejudge.org/external/104/10400.html">10400</a> <a href="http://uva.onlinejudge.org/external/104/10419.html">10419</a> <a href="http://uva.onlinejudge.org/external/104/10447.html">10447</a> <a href="http://uva.onlinejudge.org/external/105/10501.html">10501</a> <a href="http://uva.onlinejudge.org/external/105/10503.html">10503</a> <a href="http://uva.onlinejudge.org/external/105/10513.html">10513</a> <a href="http://uva.onlinejudge.org/external/105/10582.html">10582</a> <a href="http://uva.onlinejudge.org/external/106/10605.html">10605</a> <a href="http://uva.onlinejudge.org/external/106/10624.html">10624</a> <a href="http://uva.onlinejudge.org/external/106/10637.html">10637</a> <a href="http://uva.onlinejudge.org/external/1/129.html">129</a> <a href="http://uva.onlinejudge.org/external/101/10160.html">10160</a> <a href="http://uva.onlinejudge.org/external/108/10802.html">10802</a></p>

</div></div><div class="a" id="2"><div class="h">
<p class="b">Enumerate Tuples</p>
</div><div class="c">
<p class="t">© 2010  <a href="http://tkcnandy.blogspot.com/"> tkcn </a> . All rights reserved.</p>
<script src="./Backtracking_files/Backtracking.js.下载"></script><script defer="defer">backtracking.onInjectionDone('backtracking')</script>
<p class="d" id="Backtracking"><div class="G63lnkrD" style="overflow: auto; position: relative; zoom: 1;"><div style="position: relative; zoom: 1;"><div><div style="margin-bottom: 5px"> <input type="text" tabindex="0" class="G63lnkrG">ms <button type="button" tabindex="0" class="gwt-Button">Next</button> <button type="button" tabindex="0" class="gwt-Button">Play</button> <button type="button" tabindex="0" class="gwt-Button" disabled="">Stop</button> <button type="button" tabindex="0" class="gwt-Button">Reset</button> </div> <div style="float: left; font-size: 80%; padding-top:5px; padding-right:5px; margin-left: 5px;"> Real Vector: </div> <div style="float: left;"> <table class="G63lnkrE"><colgroup><col></colgroup><tbody><tr><td>?</td><td>?</td><td>?</td><td>?</td><td>?</td></tr></tbody></table> </div> <div style="float: left; font-size: 80%; padding-top:5px; padding-right:5px; margin-left: 10px;"> Selected Vector: </div> <div style="float: left;"> <table class="G63lnkrE"><colgroup><col></colgroup><tbody><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table> </div> <div class="G63lnkrF" style="overflow: auto; position: relative; zoom: 1;"><div style="position: relative; zoom: 1;"></div><ul></ul></div> <div class="G63lnkrB" style="position: relative; overflow: hidden;"><canvas width="500" height="250" style="width: 500px; height: 250px;"></canvas><div class="gwt-HTML" style="position: absolute; left: 105px; top: 30px;">0</div><div class="gwt-HTML" style="position: absolute; left: 175px; top: 30px;">1</div><div class="gwt-HTML" style="position: absolute; left: 245px; top: 30px;">2</div><div class="gwt-HTML" style="position: absolute; left: 315px; top: 30px;">3</div><div class="gwt-HTML" style="position: absolute; left: 385px; top: 30px;">4</div><div class="gwt-HTML" style="position: absolute; left: 35px; top: 120px;"></div></div></div></div></div></p>
<p class="t">Tuple</p>
<p>即是「多維度數值」。</p>
<p>例如數字 1 、 2 、 3 構成的三維數值是 {1,1,1} 、 {1,1,2} 、 {1,1,3} 、 {1,2,1} 、 {1,2,2} 、 {1,2,3} 、 …… 、 {3,3,2} 、 {3,3,3} 。</p>
<p class="t">範例：枚舉「數字 1 到 10 選擇五次」全部可能的情形</p>
<img src="./Backtracking_files/Backtracking1.png">
<p>製作一個陣列，用來存放一組可能的情形。陣列中不同的格子，就是不同的維度。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];</span></li></ol></div>
<p>例如 solution[0] = 4 表示第一個抓到的數字是 4 ， solution[4] = 9 表示第五個抓到的數字是 9 。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用來存放一組可能的情形</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">print_solution</span><span>()&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出一組可能的情形</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">i</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;n&nbsp;為現在正在枚舉的維度</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;逐步枚舉數字1到10，並且遞迴下去，繼續枚舉之後的維度。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">1</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">2</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">10</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_tuples</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>一般來說，重複很多次的程式碼，都會用迴圈進行簡化。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;n&nbsp;為現在正在枚舉的維度</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;逐步枚舉數字1到10，並且遞迴下去，繼續枚舉之後的維度。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">1</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;=</span><span class="value">10</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">i</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>

</div></div><div class="a" id="3"><div class="h">
<p class="b">Enumerate Permutations</p>
</div><div class="c">
<p class="t">Permutation</p>
<p>便是數學課本中「排列組合」的「排列」。但是這裡不是要計算排列有多少種，而是枚舉所有的排列，以字典順序枚舉。</p>
<p>例如 {1,2,3} 所有的排列就是 {1,2,3} 、 {1,3,2} 、 {2,1,3} 、 {2,3,1} 、 {3,1,2} 、 {3,2,1} 。</p>
<p class="t">範例：枚舉 {0,1,2,3,4} 所有排列</p>
<p>依序枚舉每個位置。針對每個位置，試著填入各種數字。</p>
<img src="./Backtracking_files/Backtracking2.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用來存放一組可能的答案</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">used</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄數字是否使用過，用過為&nbsp;true。</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出一組可能的答案</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;逐步枚舉數字0到4，並且遞迴下去，繼續枚舉之後的維度。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="value">0</span><span>])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用過的數字不能再用</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">0</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄用過的數字</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">0</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;第&nbsp;n&nbsp;格填入數字&nbsp;0</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;繼續枚舉之後的維度</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">0</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;回收用完的數字</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="value">1</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">1</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">1</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">1</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="value">4</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">4</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="value">4</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="value">4</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_permutations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;</span><span class="comment">//&nbsp;initialization</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出數字0到4的所有排列。</span></li><li><span>}</span></li></ol></div>
<p>一般來說，重複很多次的程式碼，都會用迴圈進行簡化。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;寫成一個迴圈</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">i</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p class="t">範例：枚舉 {0,1,2,3,4} 所有排列</p>
<p>依序枚舉每個數字。針對每個數字，試著填入各個位置。</p>
<img src="./Backtracking_files/Backtracking3.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用來存放一組可能的答案</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">filled</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄各個位置是否填過數字，填過為true</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;試著將數字&nbsp;n&nbsp;填入各個位置</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">filled</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">filled</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄填過的位置</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="word">n</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;將數字&nbsp;n&nbsp;填入第&nbsp;i&nbsp;格</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;繼續枚舉下一個數字</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">filled</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp;&nbsp;</span><span class="comment">//&nbsp;回收位置</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_permutations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;</span><span class="comment">//&nbsp;initialization</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">filled</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出數字1到5的所有排列。</span></li><li><span>}</span></li></ol></div>
<p class="t">範例：枚舉 abc 所有排列</p>
<p>這跟先前範例大同小異，程式碼稍做修改即可。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">char</span><span>&nbsp;</span><span class="word">s</span><span>[</span><span class="value">3</span><span>]&nbsp;=&nbsp;{</span><span class="char">'a'</span><span>,&nbsp;</span><span class="char">'b'</span><span>,&nbsp;</span><span class="char">'c'</span><span>};&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;字串，必須預先由小到大排序</span></li><li><span class="type">char</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">3</span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用來存放一組可能的答案</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">used</span><span>[</span><span class="value">3</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄該字母是否使用過，用過為true。</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="word">N</span><span>)&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;針對solution[i]這個位置，枚舉所有字母，並各自遞迴。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">s</span><span>[</span><span class="word">i</span><span>];&nbsp;</span><span class="comment">//&nbsp;填入字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">N</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_permutations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;</span><span class="comment">//&nbsp;initialization</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">3</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出字母abc的所有排列。</span></li><li><span>}</span></li></ol></div>
<p class="t">範例：枚舉 abb 所有排列，避免重複排列。</p>
<p>答案應該為 abb 、 aba 、 baa 。然而使用剛剛的程式碼，答案卻是這樣：</p>
<pre>abb
abb
bab
bba
bab
bba
</pre>
<p>這跟預期的不一樣。會有這種結果，是由於之前的程式有個基本假設：字串中的每個字母都不一樣。儘管出現了一樣的字母，但是程式還是當作不一樣的字母，依舊列出所有可能的排列，導致有些排列重複出現。</p>
<p>想要避免產生重複排列，在枚舉某一個位置的字母時，避免重複填入一樣的字母。若將輸入的字串由小到大排序，字母會依照順序出現，所以只需檢查方才填入的字母，判斷一不一樣，就可以避免填入一樣的字母了。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">char</span><span>&nbsp;</span><span class="word">s</span><span>[</span><span class="value">3</span><span>]&nbsp;=&nbsp;{</span><span class="char">'a'</span><span>,&nbsp;</span><span class="char">'b'</span><span>,&nbsp;</span><span class="char">'b'</span><span>};&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;字串，預先由小到大排序</span></li><li><span class="type">char</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">3</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">used</span><span>[</span><span class="value">3</span><span>];</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">char</span><span>&nbsp;</span><span class="word">last_letter</span><span>&nbsp;=&nbsp;</span><span class="char">'\0'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">s</span><span>[</span><span class="word">i</span><span>]&nbsp;!=&nbsp;</span><span class="word">last_letter</span><span>)&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;避免枚舉一樣的字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">last_letter</span><span>&nbsp;=&nbsp;</span><span class="word">s</span><span>[</span><span class="word">i</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄方才填入的字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">s</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">N</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">char</span><span>&nbsp;</span><span class="word">s</span><span>[</span><span class="value">3</span><span>]&nbsp;=&nbsp;{</span><span class="char">'a'</span><span>,&nbsp;</span><span class="char">'b'</span><span>,&nbsp;</span><span class="char">'b'</span><span>};&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;字串，預先由小到大排序</span></li><li><span class="type">char</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">3</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">used</span><span>[</span><span class="value">3</span><span>];</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">char</span><span>&nbsp;</span><span class="word">last_letter</span><span>&nbsp;=&nbsp;</span><span class="char">'\0'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;if&nbsp;not&nbsp;改成&nbsp;continue</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">used</span><span>[</span><span class="word">i</span><span>])&nbsp;</span><span class="keyword">continue</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">s</span><span>[</span><span class="word">i</span><span>]&nbsp;==&nbsp;</span><span class="word">last_letter</span><span>)&nbsp;</span><span class="keyword">continue</span><span>;&nbsp;&nbsp;</span><span class="comment">//&nbsp;避免枚舉一樣的字母</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">last_letter</span><span>&nbsp;=&nbsp;</span><span class="word">s</span><span>[</span><span class="word">i</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄剛才使用過的字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">s</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">N</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>當字母重覆出現次數很多次，此時可以使用 128 格的陣列，每一格分別存入 128 個 ASCII 字元的出現次數，簡化程式碼。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">char</span><span>&nbsp;</span><span class="word">s</span><span>[</span><span class="value">3</span><span>]&nbsp;=&nbsp;{</span><span class="char">'a'</span><span>,&nbsp;</span><span class="char">'b'</span><span>,&nbsp;</span><span class="char">'b'</span><span>};</span></li><li><span class="type">char</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">3</span><span>];</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">128</span><span>];&nbsp;</span><span class="comment">//&nbsp;分別存入&nbsp;128&nbsp;個&nbsp;ASCII&nbsp;字元的出現次數</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">N</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">128</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;枚舉每一個字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">array</span><span>[</span><span class="word">i</span><span>]&nbsp;&gt;&nbsp;</span><span class="value">0</span><span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;還有字母剩下來，就要枚舉</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">array</span><span>[</span><span class="word">i</span><span>]--;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;用掉了一個字母</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">i</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;char&nbsp;變數可以直接存入&nbsp;ascii&nbsp;數值</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">N</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">array</span><span>[</span><span class="word">i</span><span>]++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;回收了一個字母</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_permutations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;initialization</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">3</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;</span><span class="word">array</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="value">0</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">3</span><span>;&nbsp;</span><span class="word">i</span><span>++)&nbsp;</span><span class="word">array</span><span>[</span><span class="word">s</span><span>[</span><span class="word">i</span><span>]]++;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">3</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;印出字母abb的所有排列。</span></li><li><span>}</span></li></ol></div>
<p class="e">UVa <a href="http://uva.onlinejudge.org/external/1/195.html">195</a> <a href="http://uva.onlinejudge.org/external/4/441.html">441</a> <a href="http://uva.onlinejudge.org/external/100/10098.html">10098</a> <a href="http://uva.onlinejudge.org/external/100/10063.html">10063</a> <a href="http://uva.onlinejudge.org/external/107/10776.html">10776</a></p>

</div></div><div class="a" id="4"><div class="h">
<p class="b">Enumerate Combinations</p>
</div><div class="c">
<p class="t">Combination （ Subset ）</p>
<p>便是數學課本中「排列組合」的「組合」；概念等於「子集合」。但是這裡不是要計算組合有多少種，而是枚舉所有的組合，以字典順序枚舉。</p>
<p>例如 {1,2,3} 所有的組合就是 {} 、 {1} 、 {2} 、 {3} 、 {1,2} 、 {1,3} 、 {2,3} 、 {1,2,3} 。</p>
<p class="t">範例：枚舉 {0,1,2,3,4} 所有組合</p>
<p>該如何枚舉呢？先觀察平時我們計算組合個數的方法。</p>
<p>{0,1,2,3,4} 所有組合個數總共 2⁵ 個： 0 可取可不取，有兩種情形、 1 可取可不取，有兩種情形、 ... 、 4 可取可不取，有兩種情形。根據乘法原理，總共 2×2×2×2×2 = 2⁵ 種情形。</p>
<p>枚舉方式可以仿照乘法原理。建立一個陣列，當作一個集合。 solution[i] = true 表示這個集合擁有第 i 個元素，觀念等同「<a href="http://www.csie.ntnu.edu.tw/~u91029/Set.html"> Set 資料結構 :  索引儲存</a>」。</p>
<p>依序枚舉每個位置。針對每個位置，試著填入取或不取。</p>
<img src="./Backtracking_files/Backtracking4.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;索引儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">i</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字n，然後繼續枚舉之後的位置。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不取數字n，然後繼續枚舉之後的位置。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>亦得改用其他資料結構，例如「<a href="http://www.csie.ntnu.edu.tw/~u91029/Set.html"> Set 資料結構 :  循序儲存</a>」。</p>
<img src="./Backtracking_files/Backtracking5.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">subset</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;循序儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">size</span><span>)&nbsp;</span><span class="comment">//&nbsp;size為子集合大小</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;print&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">size</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">i</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字n，然後繼續枚舉剩下的數字。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">size</span><span>]&nbsp;=&nbsp;</span><span class="word">n</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不取數字n，然後繼續枚舉剩下的數字。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p class="t">範例：枚舉 {0,1,2,3,4} 所有組合</p>
<p>依序枚舉每個選取。針對每個選取，試著填入各個位置。</p>
<img src="./Backtracking_files/Backtracking6.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;索引儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;print_solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">i</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(;&nbsp;</span><span class="word">n</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;++</span><span class="word">n</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字n</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;然後繼續枚舉後面的數字</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;回復原狀</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<img src="./Backtracking_files/Backtracking7.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">subset</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;循序儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">size</span><span>)&nbsp;</span><span class="comment">//&nbsp;size為子集合大小</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;print_solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">size</span><span>;&nbsp;</span><span class="word">i</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">i</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="char">'&nbsp;'</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">endl</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(;&nbsp;</span><span class="word">n</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;++</span><span class="word">n</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字n</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">size</span><span>]&nbsp;=&nbsp;</span><span class="word">n</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;然後繼續枚舉後面的數字</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不必特地回復原狀，數字n會覆蓋過去。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p class="t">範例：枚舉 {6,7,9,4,2} 所有組合</p>
<p>預先排序數字，輸出結果就會照字典順序排列。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">5</span><span>]&nbsp;=&nbsp;{</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>,&nbsp;</span><span class="value">4</span><span>,&nbsp;</span><span class="value">2</span><span>};</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">subset</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;循序儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">size</span><span>)&nbsp;</span><span class="comment">//&nbsp;size為子集合大小</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字array[n]，然後繼續枚舉剩下的數字。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">size</span><span>]&nbsp;=&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不取數字array[n]，然後繼續枚舉剩下的數字。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">sort</span><span>(</span><span class="word">array</span><span>,&nbsp;</span><span class="word">array</span><span>+</span><span class="value">5</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">5</span><span>]&nbsp;=&nbsp;{</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>,&nbsp;</span><span class="value">4</span><span>,&nbsp;</span><span class="value">2</span><span>};</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">subset</span><span>[</span><span class="value">5</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;循序儲存</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">size</span><span>)&nbsp;</span><span class="comment">//&nbsp;size為子集合大小</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(;&nbsp;</span><span class="word">n</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;++</span><span class="word">n</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選取數字array[n]</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">subset</span><span>[</span><span class="word">size</span><span>]&nbsp;=&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>];</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;然後繼續枚舉剩下的數字</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">size</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_combinations</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">sort</span><span>(</span><span class="word">array</span><span>,&nbsp;</span><span class="word">array</span><span>+</span><span class="value">5</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>

</div></div><div class="a" id="5"><div class="h">
<p class="b">Enumerate Subset Sums</p>
</div><div class="c">
<p class="t">Subset Sum</p>
<p>例如 {1,2,8} 所有的子集和就是 0 、 1 、 2 、 8 、 1+2 、 1+8 、 2+8 、 1+2+8 。</p>
<p>直覺的解法是枚舉所有子集合，分別求總和，最後再排序。</p>
<p>可以直接由小到大枚舉嗎？可以！運用即時排序資料結構，調整回溯法的枚舉順序。每個數字都有「取」和「不取」兩種選擇，放入即時排序資料結構，由即時排序資料結構決定下一個枚舉的對象。</p>
<p>簡單起見，假設數字都是正數。首先是簡單的做法，但是有錯誤，出現多餘的零。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">const</span><span>&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>&nbsp;=&nbsp;</span><span class="value">5</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;集合大小</span></li><li><span class="keyword">const</span><span>&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">K</span><span>&nbsp;=&nbsp;</span><span class="value">6</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;枚舉前6名子集和</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="word">N</span><span>]&nbsp;=&nbsp;{</span><span class="value">2</span><span>,&nbsp;</span><span class="value">4</span><span>,&nbsp;</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>};&nbsp;</span><span class="comment">//&nbsp;集合，預先由小到大排序</span></li><li>&nbsp;</li><li><span class="keyword">struct</span><span>&nbsp;</span><span class="word">Pair</span><span>&nbsp;{</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="word">num</span><span>;};</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;STL內建的priority_queue，排序結果由大到小。</span></li><li><span class="comment">//&nbsp;因此比大小時要顛倒，排序結果才會由小到大。</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="keyword">operator</span><span>&lt;(</span><span class="keyword">const</span><span>&nbsp;</span><span class="word">Pair</span><span>&amp;&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="keyword">const</span><span>&nbsp;</span><span class="word">Pair</span><span>&amp;&nbsp;</span><span class="word">b</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">a</span><span>.</span><span class="word">num</span><span>&nbsp;&gt;&nbsp;</span><span class="word">b</span><span>.</span><span class="word">num</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_subset_sums</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;從空集合開始實施回溯法</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">priority_queue</span><span>&lt;</span><span class="word">Pair</span><span>&gt;&nbsp;</span><span class="word">pq</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>});</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">k</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">k</span><span>&lt;</span><span class="word">K</span><span>;&nbsp;</span><span class="word">k</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;找到當前最小的子集和</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">pq</span><span>.</span><span class="word">empty</span><span>())&nbsp;</span><span class="keyword">break</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>&nbsp;=&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">top</span><span>().</span><span class="word">n</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">num</span><span>&nbsp;=&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">top</span><span>().</span><span class="word">num</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">pop</span><span>();</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">num</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;遞迴到下一個維度</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;&lt;&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">num</span><span>&nbsp;+&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>]});&nbsp;</span><span class="comment">//&nbsp;取</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">num</span><span>});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不取</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>再來是正確的做法。稍作改良，避免多餘的零。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">const</span><span>&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">N</span><span>&nbsp;=&nbsp;</span><span class="value">5</span><span>;</span></li><li><span class="keyword">const</span><span>&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">K</span><span>&nbsp;=&nbsp;</span><span class="value">6</span><span>;</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="word">N</span><span>]&nbsp;=&nbsp;{</span><span class="value">2</span><span>,&nbsp;</span><span class="value">4</span><span>,&nbsp;</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>};</span></li><li>&nbsp;</li><li><span class="keyword">struct</span><span>&nbsp;</span><span class="word">Pair</span><span>&nbsp;{</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="word">num</span><span>;};</span></li><li>&nbsp;</li><li><span class="type">bool</span><span>&nbsp;</span><span class="keyword">operator</span><span>&lt;(</span><span class="keyword">const</span><span>&nbsp;</span><span class="word">Pair</span><span>&amp;&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="keyword">const</span><span>&nbsp;</span><span class="word">Pair</span><span>&amp;&nbsp;</span><span class="word">b</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">a</span><span>.</span><span class="word">num</span><span>&nbsp;&gt;&nbsp;</span><span class="word">b</span><span>.</span><span class="word">num</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">enumerate_subset_sums</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="value">0</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;預先補入一個數，稍後再扣除回來。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">priority_queue</span><span>&lt;</span><span class="word">Pair</span><span>&gt;&nbsp;</span><span class="word">pq</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="value">0</span><span>,&nbsp;</span><span class="word">array</span><span>[</span><span class="value">0</span><span>]});</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">k</span><span>=</span><span class="value">1</span><span>;&nbsp;</span><span class="word">k</span><span>&lt;</span><span class="word">K</span><span>;&nbsp;</span><span class="word">k</span><span>++)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">pq</span><span>.</span><span class="word">empty</span><span>())&nbsp;</span><span class="keyword">break</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>&nbsp;=&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">top</span><span>().</span><span class="word">n</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">num</span><span>&nbsp;=&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">top</span><span>().</span><span class="word">num</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">pop</span><span>();</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">num</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;+&nbsp;</span><span class="value">1</span><span>&nbsp;&lt;&nbsp;</span><span class="word">N</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;取</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">num</span><span>&nbsp;+&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>+</span><span class="value">1</span><span>]});</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不取</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">pq</span><span>.</span><span class="word">push</span><span>({</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">num</span><span>&nbsp;-&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>]&nbsp;+&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>+</span><span class="value">1</span><span>]});</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>

</div></div><div class="a" id="6"><div class="h">
<p class="b">8 Queen Problem</p>
</div><div class="c">
<p class="t">八皇后問題</p>
<img src="./Backtracking_files/Backtracking8.png">
<p>問題：在 8x8 的西洋棋棋盤上擺放八隻皇后，讓他們恰好無法互相攻擊對方。皇后的攻擊範圍是米字。</p>
<p>一個非常簡單的想法：每一格都有「放」和「不放」兩種選擇，枚舉所有可能，並避免枚舉皇后互相攻擊的情形。建立 8x8 的 bool 陣列，代表一個 8x8 的棋盤盤面情形。例如 solution[0][0] = true 表示 (0,0) 這個位置有放置皇后。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>][</span><span class="value">8</span><span>];</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">y</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">y</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)&nbsp;</span><span class="word">x</span><span>++,&nbsp;</span><span class="word">y</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;換到下一排格子</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">eight_queen</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>接著要避免枚舉不可能出現的答案：任一直線、橫線、左右斜線上面只能有一隻皇后。分別建立四個 bool 陣列，記錄皇后在各條線上擺放的情形。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>][</span><span class="value">8</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">mx</span><span>[</span><span class="value">8</span><span>],&nbsp;</span><span class="word">my</span><span>[</span><span class="value">8</span><span>],&nbsp;</span><span class="word">md1</span><span>[</span><span class="value">15</span><span>],&nbsp;</span><span class="word">md2</span><span>[</span><span class="value">15</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;初始值都是&nbsp;false</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">y</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">y</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)&nbsp;</span><span class="word">x</span><span>++,&nbsp;</span><span class="word">y</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;換到下一排格子</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">d1</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>+</span><span class="word">y</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>,&nbsp;</span><span class="word">d2</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>-</span><span class="word">y</span><span>+</span><span class="value">15</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;這隻皇后佔據了四條線，記得標記起來。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;遞迴結束，回復到原本的樣子，要記得取消標記。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">eight_queen</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>以及避免枚舉不可能出現的答案：最終的棋盤上面不足八隻皇后。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>][</span><span class="value">8</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">mx</span><span>[</span><span class="value">8</span><span>],&nbsp;</span><span class="word">my</span><span>[</span><span class="value">8</span><span>],&nbsp;</span><span class="word">md1</span><span>[</span><span class="value">15</span><span>],&nbsp;</span><span class="word">md2</span><span>[</span><span class="value">15</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;初始值都是&nbsp;false</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">y</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">c</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">y</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)&nbsp;</span><span class="word">x</span><span>++,&nbsp;</span><span class="word">y</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;換到下一排格子</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">c</span><span>&nbsp;!=&nbsp;</span><span class="value">8</span><span>)&nbsp;</span><span class="keyword">return</span><span>;&nbsp;</span><span class="comment">//&nbsp;不是八隻皇后就避免枚舉答案</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">d1</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>+</span><span class="word">y</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>,&nbsp;</span><span class="word">d2</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>-</span><span class="word">y</span><span>+</span><span class="value">15</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">c</span><span>+</span><span class="value">1</span><span>);&nbsp;</span><span class="comment">//&nbsp;皇后多一隻</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">mx</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不放置皇后</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>][</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">c</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;皇后和原來一樣多</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">eight_queen</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);&nbsp;</span><span class="comment">//&nbsp;一開始棋盤是空的，皇后數目為零。</span></li><li><span>}</span></li></ol></div>
<p class="t">改進</p>
<p>由於一條線必須剛好擺放一隻皇后，故可以以線為單位來遞迴窮舉。重新建立一條一維 int 陣列， solution[0] = 5 表示第零個直行上的皇后，擺在第五個位置。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>];</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>)&nbsp;</span><span class="comment">//&nbsp;每次都換一排格子</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;分別放置皇后在每一格，並各自遞迴下去。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="value">0</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="value">1</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="value">7</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>縮成迴圈是一定要的啦！</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>];</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;每次都換一排格子</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;分別放置皇后在每一格，並各自遞迴下去。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">y</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">y</span><span>&lt;</span><span class="value">8</span><span>;&nbsp;++</span><span class="word">y</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">y</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>+</span><span class="value">1</span><span>);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>接著要避免枚舉不可能出現的答案。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">8</span><span>];</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">my</span><span>[</span><span class="value">8</span><span>],&nbsp;</span><span class="word">md1</span><span>[</span><span class="value">15</span><span>],&nbsp;</span><span class="word">md2</span><span>[</span><span class="value">15</span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;初始值都是&nbsp;false</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;x這條線可以不用檢查了</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;每次都換一排格子</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">x</span><span>&nbsp;==&nbsp;</span><span class="value">8</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">print_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;分別放置皇后在每一格，並各自遞迴下去。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">y</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">y</span><span>&lt;</span><span class="value">8</span><span>;&nbsp;++</span><span class="word">y</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">d1</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>+</span><span class="word">y</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>,&nbsp;</span><span class="word">d2</span><span>&nbsp;=&nbsp;(</span><span class="word">x</span><span>-</span><span class="word">y</span><span>+</span><span class="value">15</span><span>)&nbsp;%&nbsp;</span><span class="value">15</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;&amp;&amp;&nbsp;!</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;這隻皇后佔據了四條線，記得標記起來。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;=&nbsp;</span><span class="word">y</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">x</span><span>+</span><span class="value">1</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;遞迴結束，回復到原本的樣子，要記得取消標記。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">my</span><span>[</span><span class="word">y</span><span>]&nbsp;=&nbsp;</span><span class="word">md1</span><span>[</span><span class="word">d1</span><span>]&nbsp;=&nbsp;</span><span class="word">md2</span><span>[</span><span class="word">d2</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p class="t">改進</p>
<p>8 Queen Problem 的答案是上下、左右、對角線對稱的。排除對稱的情形，可以節省枚舉的時間。這裡不加贅述。</p>
<p class="t">另一種左右斜線判斷方式</p>
<p>比用陣列記錄還麻煩。自行斟酌。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">x</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;每次都換一排格子</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">x</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">abs</span><span>(</span><span class="word">x</span><span>&nbsp;-&nbsp;</span><span class="word">i</span><span>)&nbsp;==&nbsp;</span><span class="word">abs</span><span>(</span><span class="word">solution</span><span>[</span><span class="word">x</span><span>]&nbsp;-&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>]))</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li><span>}</span></li></ol></div>
<p class="e">UVa <a href="http://uva.onlinejudge.org/external/1/167.html">167</a> <a href="http://uva.onlinejudge.org/external/7/750.html">750</a> <a href="http://uva.onlinejudge.org/external/105/10513.html">10513</a> <a href="http://uva.onlinejudge.org/external/6/639.html">639</a> <a href="http://uva.onlinejudge.org/external/9/989.html">989</a> <a href="http://uva.onlinejudge.org/external/108/10893.html">10893</a> <a href="http://uva.onlinejudge.org/external/109/10957.html">10957</a></p>

</div></div><div class="a" id="7"><div class="h">
<p class="b">0/1 Knapsack Problem</p>
</div><div class="c">
<p class="t">0/1 背包問題</p>
<img src="./Backtracking_files/Backtracking9.png">
<p>問題：各式各樣的物品，重量與價值皆異。一個背包，具有耐重限制。現在將物品儘量塞入背包，令背包裡物品總價值最高。</p>
<p>一個簡單的想法：每個物品都有「要」和「不要」兩種選擇，窮舉所有可能，並避免枚舉背包超載的情形。建立一維 bool 陣列， solution[0] = true 表示第零個物品有放進背包。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">bool</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;十個物品</span></li><li>&nbsp;</li><li><span class="type">int</span><span>&nbsp;</span><span class="word">weight</span><span>[</span><span class="value">10</span><span>]&nbsp;=&nbsp;{</span><span class="value">4</span><span>,&nbsp;</span><span class="value">54</span><span>,&nbsp;</span><span class="value">1</span><span>,&nbsp;...,&nbsp;</span><span class="value">32</span><span>};&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;十個物品分別的重量</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">cost</span><span>[</span><span class="value">10</span><span>]&nbsp;=&nbsp;{</span><span class="value">3</span><span>,&nbsp;</span><span class="value">3</span><span>,&nbsp;</span><span class="value">11</span><span>,&nbsp;...,&nbsp;</span><span class="value">23</span><span>};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;十個物品分別的價值</span></li><li>&nbsp;</li><li><span class="keyword">const</span><span>&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">maxW</span><span>&nbsp;=&nbsp;</span><span class="value">100</span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;背包承載上限</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">maxC</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;出現過的最高總值</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">w</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">c</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">10</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">c</span><span>&nbsp;&gt;&nbsp;</span><span class="word">maxC</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄總值最高的</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">maxC</span><span>&nbsp;=&nbsp;</span><span class="word">c</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">store_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;放進背包</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">w</span><span>&nbsp;+&nbsp;</span><span class="word">weight</span><span>[</span><span class="word">n</span><span>]&nbsp;&lt;=&nbsp;</span><span class="word">maxW</span><span>)&nbsp;&nbsp;</span><span class="comment">//&nbsp;檢查背包超載</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">w</span><span>&nbsp;+&nbsp;</span><span class="word">weight</span><span>[</span><span class="word">n</span><span>],&nbsp;</span><span class="word">c</span><span>&nbsp;+&nbsp;</span><span class="word">cost</span><span>[</span><span class="word">n</span><span>]);</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不放進背包</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">w</span><span>,&nbsp;</span><span class="word">c</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li>&nbsp;</li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">answer</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;正確答案</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">store_solution</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">10</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">answer</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>}</span></li></ol></div>
<p>檢查背包超載的部分可以修改成更美觀的樣子。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">w</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">c</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">w</span><span>&nbsp;&gt;&nbsp;</span><span class="word">maxW</span><span>)&nbsp;</span><span class="keyword">return</span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;背包超載</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">10</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">c</span><span>&nbsp;&gt;&nbsp;</span><span class="word">maxC</span><span>)&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄總值最高的</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">maxC</span><span>&nbsp;=&nbsp;</span><span class="word">c</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">store_solution</span><span>();</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;放進背包</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">w</span><span>&nbsp;+&nbsp;</span><span class="word">weight</span><span>[</span><span class="word">n</span><span>],&nbsp;</span><span class="word">c</span><span>&nbsp;+&nbsp;</span><span class="word">cost</span><span>[</span><span class="word">n</span><span>]);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不放進背包</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">w</span><span>,&nbsp;</span><span class="word">c</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>各位可以預先排序物品重量，再執行程式，看看效率有何不同。然後嘗試使用 heuristic bound 加快速度。</p>

</div></div><div class="a" id="8"><div class="h">
<p class="b">Inclusion-Exclusion Principle</p>
</div><div class="c">
</div><div class="c">
<p class="t">排容原理</p>
<img src="./Backtracking_files/Backtracking10.png">
<p>類似於枚舉所有子集合，但是每個子集合有正負號之別 ── 奇數個集合的交集為正號、偶數個集合的交集為負號。</p>
<p>舉例：求出 1 到 100 當中不可被 3 或 5 或 8 整除的整數有幾個。 3 、 5 、 8 均兩兩互質。</p>
<img src="./Backtracking_files/Backtracking11.png">
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">3</span><span>]&nbsp;=&nbsp;{</span><span class="value">3</span><span>,&nbsp;</span><span class="value">5</span><span>,&nbsp;</span><span class="value">8</span><span>};</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;排容，sign為正負號，divisor為各種可能的除數</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">sign</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">divisor</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">3</span><span>)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">sign</span><span>&nbsp;*&nbsp;(</span><span class="value">100</span><span>&nbsp;/&nbsp;</span><span class="word">divisor</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">total</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;不選。正負號維持不變，除數維持不變。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;solution[n]&nbsp;=&nbsp;false;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">total</span><span>&nbsp;+=&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">sign</span><span>,&nbsp;</span><span class="word">divisor</span><span>);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;選。須變號，並逐步累計除數。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;因逐步累計除數，故不需要具體記錄選到的數字</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;solution[n]&nbsp;=&nbsp;true;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">total</span><span>&nbsp;+=&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;-</span><span class="word">sign</span><span>,&nbsp;</span><span class="word">divisor</span><span>&nbsp;*&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>]);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">total</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">inclusion_exclusion</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"1到100當中不可被3或5或8整除的整數"</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"有"</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;+</span><span class="value">1</span><span>,&nbsp;</span><span class="value">1</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="string">"個"</span><span>;</span></li><li><span>}</span></li></ol></div>
<p>考慮數字之間不互質的一般情形：</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">5</span><span>]&nbsp;=&nbsp;{</span><span class="value">3</span><span>,&nbsp;</span><span class="value">5</span><span>,&nbsp;</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>};</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;最大公因數</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">gcd</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">b</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">b</span><span>&nbsp;?&nbsp;</span><span class="word">gcd</span><span>(</span><span class="word">b</span><span>,&nbsp;</span><span class="word">a</span><span>%</span><span class="word">b</span><span>)&nbsp;:&nbsp;</span><span class="word">a</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;最小公倍數</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">lcm</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">b</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">a</span><span>&nbsp;/&nbsp;</span><span class="word">gcd</span><span>(</span><span class="word">a</span><span>,&nbsp;</span><span class="word">b</span><span>)&nbsp;*&nbsp;</span><span class="word">b</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;精簡過後的排容程式碼，divisor為各種可能的除數</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">divisor</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;==&nbsp;</span><span class="value">5</span><span>)&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="value">100</span><span>&nbsp;/&nbsp;</span><span class="word">divisor</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">divisor</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">lcm</span><span>(</span><span class="word">divisor</span><span>,&nbsp;</span><span class="word">array</span><span>[</span><span class="word">n</span><span>]));</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">inclusion_exclusion</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"1到100當中不可被3或5或6或7或9整除的整數"</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"有"</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">1</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="string">"個"</span><span>;</span></li><li><span>}</span></li></ol></div>
<p>枚舉子集合（組合）有兩種枚舉方式，排容原理亦有兩種枚舉方式。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="type">int</span><span>&nbsp;</span><span class="word">array</span><span>[</span><span class="value">5</span><span>]&nbsp;=&nbsp;{</span><span class="value">3</span><span>,&nbsp;</span><span class="value">5</span><span>,&nbsp;</span><span class="value">6</span><span>,&nbsp;</span><span class="value">7</span><span>,&nbsp;</span><span class="value">9</span><span>};</span></li><li>&nbsp;</li><li><span class="type">int</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">divisor</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">total</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">total</span><span>&nbsp;+=&nbsp;</span><span class="value">100</span><span>&nbsp;/&nbsp;</span><span class="word">divisor</span><span>;&nbsp;</span><span class="comment">//&nbsp;目前湊出來的集合</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;繼續枚舉之後的數字，記得變號</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="word">n</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="value">5</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">total</span><span>&nbsp;-=&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">i</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">lcm</span><span>(</span><span class="word">divisor</span><span>,&nbsp;</span><span class="word">array</span><span>[</span><span class="word">i</span><span>]));</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">total</span><span>;</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">inclusion_exclusion</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"1到100當中不可被3或5或6或7或9整除的整數"</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">cout</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="string">"有"</span><span>&nbsp;&lt;&lt;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>,&nbsp;</span><span class="value">1</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="string">"個"</span><span>;</span></li><li><span>}</span></li></ol></div>
<p class="e">UVa <a href="http://uva.onlinejudge.org/external/103/10325.html">10325</a></p>

</div></div><div class="a" id="9"><div class="h">
<p class="b">Euclidean Shortest Path</p>
</div><div class="c">
<p class="t">© 2010  <a href="http://tkcnandy.blogspot.com/"> tkcn </a> . All rights reserved.</p>
<script src="./Backtracking_files/EuclideanShortestPath.js.下载"></script><script defer="defer">euclideanshortestpath.onInjectionDone('euclideanshortestpath')</script>
<p class="d" id="EuclideanShortestPath"><div class="GFXAJ1NJF" style="overflow: auto; position: relative; zoom: 1;"><div style="position: relative; zoom: 1;"><div><div style="margin-bottom: 8px;"> <input type="text" class="GFXAJ1NKF"> ms <button type="button" class="gwt-Button">Next</button> <button type="button" class="gwt-Button">Play</button> <button type="button" class="gwt-Button" disabled="">Stop</button> <button type="button" class="gwt-Button">Reset</button> </div> <div style="margin-bottom: 8px;"> <span class="gwt-RadioButton"><input type="radio" name="bounding" id="gwt-uid-7" tabindex="0" checked=""><label for="gwt-uid-7">Bounding</label></span> <span class="gwt-RadioButton"><input type="radio" name="bounding" id="gwt-uid-9" tabindex="0"><label for="gwt-uid-9">Heuristic Bounding</label></span> </div> <div class="GFXAJ1NIF" style="position: relative; overflow: hidden;"><canvas width="500" height="300" style="width: 500px; height: 300px;"></canvas></div> <div style="font-size: small;"> ※ 當下生成的路徑片段，是深紅色粗線&nbsp;&nbsp; ※ 直至當前所找到的最短路徑，是深金色粗線 </div></div></div></div></p>
<p class="t">二維座標平面，兩點之間的最短路徑</p>
<p>在一張地圖上有很多個地點，鄰近的地點有筆直道路相通，我們也知道每一段道路的長度。現在要沿著道路，從一個地點走到另一個地點，請問要怎麼走距離最短呢？</p>
<p>一條最短的路徑，肯定不會繞圈子。我們可以窮舉所有排列，製造所有可能的路徑。每當生成一條路徑，就判斷這條路徑是不是歷來最短的路徑，並且隨時記得歷來最短的路徑。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">struct</span><span>&nbsp;</span><span class="word">Point</span><span>&nbsp;{</span><span class="type">double</span><span>&nbsp;</span><span class="word">x</span><span>,&nbsp;</span><span class="word">y</span><span>;}&nbsp;</span><span class="word">p</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;所有地點的座標，</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;編號為&nbsp;0&nbsp;到&nbsp;9。</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">connect</span><span>[</span><span class="value">10</span><span>][</span><span class="value">10</span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;兩個地點之間是否有筆直道路相通</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;若相通為&nbsp;true，不相通為&nbsp;false。</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">s</span><span>&nbsp;=&nbsp;</span><span class="value">0</span><span>,&nbsp;</span><span class="word">t</span><span>&nbsp;=&nbsp;</span><span class="value">9</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;起點與終點的編號</span></li><li>&nbsp;</li><li><span class="type">int</span><span>&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;一條可能的路徑</span></li><li><span class="type">bool</span><span>&nbsp;</span><span class="word">used</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄數字是否使用過，用過為&nbsp;true。</span></li><li>&nbsp;</li><li><span class="type">int</span><span>&nbsp;</span><span class="word">best_solution</span><span>[</span><span class="value">10</span><span>];&nbsp;&nbsp;</span><span class="comment">//&nbsp;隨時記得歷來最短的路徑</span></li><li><span class="type">int</span><span>&nbsp;</span><span class="word">best_dist</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;隨時記得歷來最短的路徑的長度</span></li><li>&nbsp;</li><li><span class="comment">//&nbsp;計算兩點之間的直線距離</span></li><li><span class="type">double</span><span>&nbsp;</span><span class="word">length</span><span>(</span><span class="word">Point</span><span>&amp;&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="word">Point</span><span>&amp;&nbsp;</span><span class="word">b</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="type">double</span><span>&nbsp;</span><span class="word">dx</span><span>&nbsp;=&nbsp;</span><span class="word">b</span><span>.</span><span class="word">x</span><span>&nbsp;-&nbsp;</span><span class="word">a</span><span>.</span><span class="word">x</span><span>,&nbsp;</span><span class="word">dy</span><span>&nbsp;=&nbsp;</span><span class="word">b</span><span>.</span><span class="word">y</span><span>&nbsp;-&nbsp;</span><span class="word">a</span><span>.</span><span class="word">y</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="word">sqrt</span><span>(</span><span class="word">dx</span><span>&nbsp;*&nbsp;</span><span class="word">dx</span><span>&nbsp;+&nbsp;</span><span class="word">dy</span><span>&nbsp;*&nbsp;</span><span class="word">dy</span><span>);</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">dist</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;prune，生成不合理的解答就馬上回溯。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">n</span><span>&nbsp;&gt;&nbsp;</span><span class="value">2</span><span>&nbsp;&amp;&amp;&nbsp;!</span><span class="word">connect</span><span>[</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>-</span><span class="value">2</span><span>]][</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>-</span><span class="value">1</span><span>]])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">a</span><span>&nbsp;==&nbsp;</span><span class="word">t</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄歷來最短的路徑</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">dist</span><span>&nbsp;&lt;&nbsp;</span><span class="word">best_dist</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_dist</span><span>&nbsp;=&nbsp;</span><span class="word">dist</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">n</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_solution</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;窮舉所有排列</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">b</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">b</span><span>&lt;</span><span class="value">10</span><span>;&nbsp;++</span><span class="word">b</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="word">b</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">b</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">b</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">b</span><span>,&nbsp;</span><span class="word">dist</span><span>&nbsp;+&nbsp;</span><span class="word">length</span><span>(</span><span class="word">p</span><span>[</span><span class="word">a</span><span>],&nbsp;</span><span class="word">p</span><span>[</span><span class="word">b</span><span>]);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">b</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li><li>&nbsp;</li><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">Euclidean_shortest_path</span><span>()</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_dist</span><span>&nbsp;=&nbsp;</span><span class="value">1e9</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;設定為很大的數值，代表無限遠。</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">s</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;設定好起步起點</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="value">0</span><span>]&nbsp;=&nbsp;</span><span class="word">s</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="value">0</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="value">0</span><span>,&nbsp;</span><span class="value">0</span><span>);</span></li><li><span>}</span></li></ol></div>
<p>prune 的程式碼，可以放在遞迴函式一開始的地方，也可以放在遞迴函式呼叫的前一刻。視情況選用直觀易懂的寫法。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">dist</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;it's&nbsp;a&nbsp;solution</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">a</span><span>&nbsp;==&nbsp;</span><span class="word">t</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;記錄歷來最短的路徑</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">dist</span><span>&nbsp;&lt;&nbsp;</span><span class="word">best_dist</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_dist</span><span>&nbsp;=&nbsp;</span><span class="word">dist</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">i</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">i</span><span>&lt;</span><span class="word">n</span><span>;&nbsp;++</span><span class="word">i</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">best_solution</span><span>[</span><span class="word">i</span><span>]&nbsp;=&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">i</span><span>];</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;窮舉所有排列</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">for</span><span>&nbsp;(</span><span class="type">int</span><span>&nbsp;</span><span class="word">b</span><span>=</span><span class="value">0</span><span>;&nbsp;</span><span class="word">b</span><span>&lt;</span><span class="value">10</span><span>;&nbsp;++</span><span class="word">b</span><span>)</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">connect</span><span>[</span><span class="word">a</span><span>][</span><span class="word">b</span><span>])&nbsp;&nbsp;</span><span class="comment">//&nbsp;prune，有路才能通行。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!</span><span class="word">used</span><span>[</span><span class="word">b</span><span>])</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">b</span><span>]&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">solution</span><span>[</span><span class="word">n</span><span>]&nbsp;=&nbsp;</span><span class="word">b</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="word">n</span><span>+</span><span class="value">1</span><span>,&nbsp;</span><span class="word">b</span><span>,&nbsp;</span><span class="word">dist</span><span>&nbsp;+&nbsp;</span><span class="word">length</span><span>(</span><span class="word">p</span><span>[</span><span class="word">a</span><span>],&nbsp;</span><span class="word">p</span><span>[</span><span class="word">b</span><span>]);</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="word">used</span><span>[</span><span class="word">b</span><span>]&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li><li><span>}</span></li></ol></div>
<p>很多人誤認 backtracking 就是圖論中的 DFS ，然而兩者沒有關係。兩者相似的地方是： backtracking 遇到不合理的解答會馬上回溯， DFS 遇到拜訪過的節點會馬上回溯。</p>
<p class="t">Bounding</p>
<p>遞迴過程中，如果當下產生的路徑片段，已經超過歷來最短的路徑長度，則可以馬上回溯。堅持遞迴下去，路徑片段只會越變越長，將來仍然是超過歷來最短的路徑長度，根本不可能構成正確解答 ── 不如當下就回溯，及早發現及早治療。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">dist</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;bound</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;路徑片段已經太長，窮舉下去沒有意義了，可以馬上回溯。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">dist</span><span>&nbsp;&gt;=&nbsp;</span><span class="word">best_dist</span><span>)&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li><span>}</span></li></ol></div>
<p class="t">Heuristic Bounding</p>
<p>遞迴過程中，如果當下產生的片段路徑，我們預測它延伸到終點之後，鐵定超過歷來最短的路徑長度，則可以馬上回溯。先知先覺，防範未然，少走許多冤枉路。</p>
<div class="sh"><div class="bar">&nbsp;</div><ol><li><span class="keyword">void</span><span>&nbsp;</span><span class="word">backtrack</span><span>(</span><span class="type">int</span><span>&nbsp;</span><span class="word">n</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">a</span><span>,&nbsp;</span><span class="type">int</span><span>&nbsp;</span><span class="word">dist</span><span>)</span></li><li><span>{</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;heuristic&nbsp;bound</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;還沒到之前，如果發現已經太遠了，就不繼續走，改換條路。</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="word">dist</span><span>&nbsp;+&nbsp;</span><span class="word">length</span><span>(</span><span class="word">p</span><span>[</span><span class="word">a</span><span>],&nbsp;</span><span class="word">p</span><span>[</span><span class="word">t</span><span>])&nbsp;&gt;=&nbsp;</span><span class="word">best_dist</span><span>)&nbsp;</span><span class="keyword">return</span><span>;</span></li><li>&nbsp;</li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;......</span></li><li><span>}</span></li></ol></div>
<p>這個問題可以套用最短路徑演算法，甚至可以使用 A* 、 IDA* 解決。不過這已經超出回溯法的範圍了。</p>
</div></div><script src="./Backtracking_files/h.js.下载"></script><div class="m"><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/index.html">◀ Index</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#1">Backtracking</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#2">Enumerate Tuples</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#3">Enumerate Permutations</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#4">Enumerate Combinations</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#5">Enumerate Subset Sums</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#6">8 Queen Problem</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#7">0/1 Knapsack Problem</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#8">Inclusion-Exclusion Principle</a></div><div class="li"><a href="http://www.csie.ntnu.edu.tw/~u91029/Backtracking.html#9">Euclidean Shortest Path</a></div></div><iframe src="javascript:&#39;&#39;" id="backtracking" tabindex="-1" style="position: absolute; width: 0px; height: 0px; border: none;" src="./Backtracking_files/saved_resource.html"></iframe><iframe src="javascript:&#39;&#39;" id="euclideanshortestpath" tabindex="-1" style="position: absolute; width: 0px; height: 0px; border: none;" src="./Backtracking_files/saved_resource(1).html"></iframe><div style="display: none;"></div><div style="display: none;"></div></body></html>